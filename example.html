<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MultiColorReplaceFilter Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }
        #app {
            text-align: center;
        }
        canvas {
            border: 2px solid #333;
            margin: 20px 0;
        }
        .controls {
            margin: 20px 0;
        }
        button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        .info {
            max-width: 800px;
            margin: 0 auto;
            text-align: left;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div id="app">
        <h1>MultiColorReplaceFilter デモ</h1>
        <div id="pixiContainer"></div>
        
        <div class="controls">
            <button id="btnRedToBlue">赤 → 青</button>
            <button id="btnGreenToYellow">緑 → 黄色</button>
            <button id="btnMultiColor">マルチカラー置換</button>
            <button id="btnReset">リセット</button>
        </div>

        <div class="info">
            <h3>使用方法</h3>
            <p>このデモでは、PixiJS用のMultiColorReplaceFilterの動作を確認できます。</p>
            <ul>
                <li><strong>赤 → 青:</strong> 画像内の赤色を青色に置換</li>
                <li><strong>緑 → 黄色:</strong> 画像内の緑色を黄色に置換</li>
                <li><strong>マルチカラー置換:</strong> 複数の色を同時に置換</li>
                <li><strong>リセット:</strong> 元の画像に戻す</li>
            </ul>
            
            <h3>実装例</h3>
            <pre><code>import { MultiColorReplaceFilter } from '@volgakurvar/pixi-filter-multi-color-replace';

// 単一色の置換
const filter = new MultiColorReplaceFilter({
  replacements: [[0xFF0000, 0x0000FF]], // 赤 → 青
  tolerance: 0.05
});

// 複数色の同時置換
const multiFilter = new MultiColorReplaceFilter({
  replacements: [
    [0xFF0000, 0x0000FF], // 赤 → 青
    [0x00FF00, 0xFFFF00], // 緑 → 黄色
    [0x0000FF, 0xFF0000]  // 青 → 赤
  ],
  tolerance: 0.1
});

sprite.filters = [filter];</code></pre>
        </div>
    </div>

    <script src="https://pixijs.download/release/pixi.min.js"></script>
    <script>
        // PixiJSアプリケーションの初期化
        const app = new PIXI.Application({
            width: 800,
            height: 600,
            backgroundColor: 0x1099bb,
        });

        document.getElementById('pixiContainer').appendChild(app.view);

        // カラフルな図形を作成してテスト用画像を生成
        const container = new PIXI.Container();
        
        // 赤い四角
        const redRect = new PIXI.Graphics();
        redRect.beginFill(0xFF0000);
        redRect.drawRect(100, 100, 100, 100);
        redRect.endFill();
        container.addChild(redRect);

        // 緑の円
        const greenCircle = new PIXI.Graphics();
        greenCircle.beginFill(0x00FF00);
        greenCircle.drawCircle(400, 150, 50);
        greenCircle.endFill();
        container.addChild(greenCircle);

        // 青い三角形
        const blueTriangle = new PIXI.Graphics();
        blueTriangle.beginFill(0x0000FF);
        blueTriangle.moveTo(600, 200);
        blueTriangle.lineTo(650, 100);
        blueTriangle.lineTo(700, 200);
        blueTriangle.lineTo(600, 200);
        blueTriangle.endFill();
        container.addChild(blueTriangle);

        // 複数色のグラデーション風
        for (let i = 0; i < 50; i++) {
            const rect = new PIXI.Graphics();
            const hue = (i / 50) * 360;
            const color = PIXI.utils.rgb2hex([
                Math.sin((hue * Math.PI) / 180) * 0.5 + 0.5,
                Math.sin(((hue + 120) * Math.PI) / 180) * 0.5 + 0.5,
                Math.sin(((hue + 240) * Math.PI) / 180) * 0.5 + 0.5
            ]);
            rect.beginFill(color);
            rect.drawRect(100 + i * 12, 350, 10, 100);
            rect.endFill();
            container.addChild(rect);
        }

        app.stage.addChild(container);

        // MultiColorReplaceFilterを模擬（実際のfilterの代わりにColorMatrixFilterで代用）
        let currentFilter = null;

        // ボタンのイベントリスナー
        document.getElementById('btnRedToBlue').addEventListener('click', () => {
            // 赤→青の色置換を模擬
            // 実際のMultiColorReplaceFilterを使用する場合の例
            console.log('赤→青の置換を適用（実際の実装では MultiColorReplaceFilter を使用）');
            
            // デモ用の色調整（実際のフィルターではありません）
            const colorMatrix = new PIXI.filters.ColorMatrixFilter();
            colorMatrix.matrix = [
                0, 0, 1, 0, 0,  // 赤成分を青に
                0, 1, 0, 0, 0,  // 緑成分はそのまま
                1, 0, 0, 0, 0,  // 青成分を赤に
                0, 0, 0, 1, 0   // アルファはそのまま
            ];
            
            container.filters = [colorMatrix];
            currentFilter = 'redToBlue';
        });

        document.getElementById('btnGreenToYellow').addEventListener('click', () => {
            console.log('緑→黄色の置換を適用');
            
            const colorMatrix = new PIXI.filters.ColorMatrixFilter();
            colorMatrix.matrix = [
                1, 1, 0, 0, 0,  // 赤成分に緑成分を追加
                1, 1, 0, 0, 0,  // 緑成分はそのまま
                0, 0, 1, 0, 0,  // 青成分はそのまま
                0, 0, 0, 1, 0   // アルファはそのまま
            ];
            
            container.filters = [colorMatrix];
            currentFilter = 'greenToYellow';
        });

        document.getElementById('btnMultiColor').addEventListener('click', () => {
            console.log('マルチカラー置換を適用');
            
            // 複数の色変換を組み合わせた効果
            const colorMatrix = new PIXI.filters.ColorMatrixFilter();
            colorMatrix.matrix = [
                0, 1, 0, 0, 0,  // 赤←緑
                0, 0, 1, 0, 0,  // 緑←青
                1, 0, 0, 0, 0,  // 青←赤
                0, 0, 0, 1, 0   // アルファはそのまま
            ];
            
            container.filters = [colorMatrix];
            currentFilter = 'multiColor';
        });

        document.getElementById('btnReset').addEventListener('click', () => {
            console.log('フィルターをリセット');
            container.filters = [];
            currentFilter = null;
        });

        // 情報表示
        console.log('MultiColorReplaceFilter テストアプリケーション');
        console.log('実際の使用では、dist/index.js をインポートして MultiColorReplaceFilter を使用してください');
    </script>
</body>
</html>